name: Stale Issues Management

on:
  schedule:
    # Run daily at 1:00 AM UTC
    - cron: '0 1 * * *'
  workflow_dispatch:  # Allow manual trigger

jobs:
  stale:
    name: Mark Stale Issues and PRs
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write

    steps:
      - uses: actions/stale@v9
        with:
          # Issue settings
          stale-issue-message: |
            This issue has been automatically marked as stale because it has not had 
            recent activity. It will be closed in 7 days if no further activity occurs.
            
            If this issue is still relevant:
            - Add a comment explaining why it should remain open
            - Add the `pinned` label to prevent auto-closing
          stale-issue-label: 'stale'
          days-before-issue-stale: 60
          days-before-issue-close: 7
          exempt-issue-labels: 'pinned,security,bug'

          # PR settings
          stale-pr-message: |
            This Pull Request has been automatically marked as stale because it has not had
            recent activity. It will be closed in 14 days if no further activity occurs.
            
            Please update this PR or add a comment if you're still working on it.
          stale-pr-label: 'stale'
          days-before-pr-stale: 30
          days-before-pr-close: 14
          exempt-pr-labels: 'pinned,work-in-progress'

          # General settings
          operations-per-run: 100
          remove-stale-when-updated: true
